#[cfg(test)]
mod tests {
    use std::{path::Path, sync::Arc};

    use crate::base::{
        asset::in_memory_asset_data_provider::InMemoryAssetDataProvider,
        components::{component_context::ComponentContext, testing::ComponentTestSnapshot},
        execution_context::ExecutionContext,
        strategy::{
            orderbook_i::{Order, OrderBook, OrderBookConfig},
            strategy_execution_context_i::{
                StrategyExecutionContext, StrategyExecutionContextConfig,
            },
            trade::{
                compute_fill_size, compute_pnl, compute_return, compute_trade_pnl, Trade,
                TradeDirection,
            },
        },
    };

    fn _test(
        cctx: &mut ComponentContext,
        target: &mut StrategyExecutionContext,
        trades: &[Option<TradeDirection>],
        expected: &[Option<(Option<Trade>, Vec<Trade>)>],
    ) {
        let mut snapshot = ComponentTestSnapshot::<(Option<Trade>, Vec<Trade>)>::new();
        for cctx in cctx {
            let ctx = cctx.get();
            let tick = ctx.current_tick;
            let trade_direction = trades[tick];
            let output = target.next(trade_direction);
            snapshot.push(Some((output.map(|x| *x), target.trades.clone())))
        }
        snapshot.assert(expected);
    }

    fn _test_current_trade(
        cctx: &mut ComponentContext,
        target: &mut StrategyExecutionContext,
        trades: &[Option<TradeDirection>],
        expected: &[Option<Trade>],
    ) {
        let mut snapshot = ComponentTestSnapshot::<Trade>::new();
        for cctx in cctx {
            let ctx = cctx.get();
            let tick = ctx.current_tick;
            let trade_direction = trades[tick];
            let output = target.next(trade_direction);
            snapshot.push(output.map(|x| *x))
        }
        snapshot.assert(expected);
    }

    fn _test_trades_history(
        cctx: &mut ComponentContext,
        target: &mut StrategyExecutionContext,
        trades: &[Option<TradeDirection>],
        expected: &[Option<Vec<Trade>>],
    ) {
        let mut snapshot = ComponentTestSnapshot::<Vec<Trade>>::new();
        for cctx in cctx {
            let ctx = cctx.get();
            let tick = ctx.current_tick;
            let trade_direction = trades[tick];
            let output = target.next(trade_direction);
            snapshot.push(Some(target.trades.clone()))
        }
        snapshot.assert(expected);
    }

    #[test]
    fn empty_on_bar_close_continous() {
        let ctx = ComponentContext::build(ExecutionContext::from_asset(Arc::from(
            InMemoryAssetDataProvider::from_values(Vec::from([
                Some(1.0),
                Some(2.0),
                Some(3.0),
                Some(4.0),
                Some(5.0),
            ])),
        )));

        _test(
            &mut ctx.clone(),
            &mut StrategyExecutionContext::new(
                ctx.clone(),
                StrategyExecutionContextConfig {
                    continous: true,
                    on_bar_close: true,
                },
            ),
            &[None, None, None, None, None],
            &[
                Some((None, vec![])),
                Some((None, vec![])),
                Some((None, vec![])),
                Some((None, vec![])),
                Some((None, vec![])),
            ],
        );
    }

    #[test]
    fn trades_history_on_bar_close_continous() {
        let ctx = ComponentContext::build(ExecutionContext::from_asset(Arc::from(
            InMemoryAssetDataProvider::from_values(Vec::from([
                Some(1.0),
                Some(2.0),
                Some(3.0),
                Some(4.0),
                Some(5.0),
                Some(6.0),
                Some(7.0),
                Some(8.0),
                Some(9.0),
                Some(10.0),
                Some(11.0),
                Some(12.0),
                Some(13.0),
                Some(14.0),
                Some(15.0),
                Some(16.0),
                Some(17.0),
                Some(18.0),
                Some(19.0),
                Some(20.0),
                Some(21.0),
                Some(22.0),
                Some(23.0),
                Some(24.0),
                Some(25.0),
                Some(26.0),
                Some(27.0),
                Some(28.0),
                Some(29.0),
            ])),
        )));

        _test_trades_history(
            &mut ctx.clone(),
            &mut StrategyExecutionContext::new(
                ctx.clone(),
                StrategyExecutionContextConfig {
                    continous: true,
                    on_bar_close: true,
                },
            ),
            &[
                // 0
                None,
                // 1
                None,
                // 2
                Some(TradeDirection::Short),
                // 3
                None,
                // 4
                Some(TradeDirection::Long),
                // 5
                None,
                // 6
                None,
                // 7
                Some(TradeDirection::Short),
                // 8
                Some(TradeDirection::Long),
                // 9
                Some(TradeDirection::Short),
                // 10
                None,
                // 11
                None,
                // 12
                None,
                // 13
                None,
                // 14
                Some(TradeDirection::Long),
                // 15
                None,
                // 16
                None,
                // 17
                None,
                // 18
                None,
                // 19
                Some(TradeDirection::Short),
                // 20
                None,
                // 21
                None,
                // 22
                None,
                // 23
                None,
                // 24
                Some(TradeDirection::Long),
                // 25
                None,
                // 26
                None,
                // 27
                None,
                // 28
                None,
            ],
            &[
                // 0
                Some(vec![]),
                // 1
                Some(vec![]),
                // 2
                Some(vec![Trade {
                    direction: TradeDirection::Short,
                    is_closed: false,
                    entry_price: Some(3.0),
                    entry_tick: Some(2),
                    exit_price: None,
                    exit_tick: None,
                }]),
                // 3
                Some(vec![Trade {
                    direction: TradeDirection::Short,
                    is_closed: false,
                    entry_price: Some(3.0),
                    entry_tick: Some(2),
                    exit_price: None,
                    exit_tick: None,
                }]),
                // 4
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 5
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 6
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 7
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 8
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 9
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 10
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 11
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 12
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 13
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 14
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 15
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 16
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 17
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 18
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 19
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: Some(20.0),
                        exit_tick: Some(19),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(20.0),
                        entry_tick: Some(19),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 20
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: Some(20.0),
                        exit_tick: Some(19),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(20.0),
                        entry_tick: Some(19),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 21
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: Some(20.0),
                        exit_tick: Some(19),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(20.0),
                        entry_tick: Some(19),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 22
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: Some(20.0),
                        exit_tick: Some(19),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(20.0),
                        entry_tick: Some(19),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 23
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: Some(20.0),
                        exit_tick: Some(19),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(20.0),
                        entry_tick: Some(19),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 24
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: Some(20.0),
                        exit_tick: Some(19),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(20.0),
                        entry_tick: Some(19),
                        exit_price: Some(25.0),
                        exit_tick: Some(24),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(25.0),
                        entry_tick: Some(24),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 25
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: Some(20.0),
                        exit_tick: Some(19),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(20.0),
                        entry_tick: Some(19),
                        exit_price: Some(25.0),
                        exit_tick: Some(24),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(25.0),
                        entry_tick: Some(24),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 26
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: Some(20.0),
                        exit_tick: Some(19),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(20.0),
                        entry_tick: Some(19),
                        exit_price: Some(25.0),
                        exit_tick: Some(24),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(25.0),
                        entry_tick: Some(24),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 27
                // 24
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: Some(20.0),
                        exit_tick: Some(19),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(20.0),
                        entry_tick: Some(19),
                        exit_price: Some(25.0),
                        exit_tick: Some(24),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(25.0),
                        entry_tick: Some(24),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 28
                // 24
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(3.0),
                        entry_tick: Some(2),
                        exit_price: Some(5.0),
                        exit_tick: Some(4),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(5.0),
                        entry_tick: Some(4),
                        exit_price: Some(8.0),
                        exit_tick: Some(7),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(8.0),
                        entry_tick: Some(7),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(15.0),
                        exit_tick: Some(14),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(15.0),
                        entry_tick: Some(14),
                        exit_price: Some(20.0),
                        exit_tick: Some(19),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(20.0),
                        entry_tick: Some(19),
                        exit_price: Some(25.0),
                        exit_tick: Some(24),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(25.0),
                        entry_tick: Some(24),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
            ],
        );
    }

    #[test]
    fn trades_history_next_bar_open_continous() {
        let ctx = ComponentContext::build(ExecutionContext::from_asset(Arc::from(
            InMemoryAssetDataProvider::from_values(Vec::from([
                Some(1.0),
                Some(2.0),
                Some(3.0),
                Some(4.0),
                Some(5.0),
                Some(6.0),
                Some(7.0),
                Some(8.0),
                Some(9.0),
                Some(10.0),
                Some(11.0),
                Some(12.0),
                Some(13.0),
                Some(14.0),
                Some(15.0),
                Some(16.0),
                Some(17.0),
                Some(18.0),
                Some(19.0),
                Some(20.0),
                Some(21.0),
                Some(22.0),
                Some(23.0),
                Some(24.0),
                Some(25.0),
                Some(26.0),
                Some(27.0),
                Some(28.0),
                Some(29.0),
            ])),
        )));

        _test_trades_history(
            &mut ctx.clone(),
            &mut StrategyExecutionContext::new(
                ctx.clone(),
                StrategyExecutionContextConfig {
                    continous: true,
                    on_bar_close: false,
                },
            ),
            &[
                // 0
                None,
                // 1
                None,
                // 2
                Some(TradeDirection::Short),
                // 3
                None,
                // 4
                Some(TradeDirection::Long),
                // 5
                None,
                // 6
                None,
                // 7
                Some(TradeDirection::Short),
                // 8
                Some(TradeDirection::Long),
                // 9
                Some(TradeDirection::Short),
                // 10
                None,
                // 11
                None,
                // 12
                None,
                // 13
                None,
                // 14
                Some(TradeDirection::Long),
                // 15
                None,
                // 16
                None,
                // 17
                None,
                // 18
                None,
                // 19
                Some(TradeDirection::Short),
                // 20
                None,
                // 21
                None,
                // 22
                None,
                // 23
                None,
                // 24
                Some(TradeDirection::Long),
                // 25
                None,
                // 26
                None,
                // 27
                None,
                // 28
                None,
            ],
            &[
                // 0
                Some(vec![]),
                // 1
                Some(vec![]),
                // 2
                Some(vec![]),
                // 3
                Some(vec![Trade {
                    direction: TradeDirection::Short,
                    is_closed: false,
                    entry_price: Some(4.0),
                    entry_tick: Some(3),
                    exit_price: None,
                    exit_tick: None,
                }]),
                // 4
                Some(vec![Trade {
                    direction: TradeDirection::Short,
                    is_closed: false,
                    entry_price: Some(4.0),
                    entry_tick: Some(3),
                    exit_price: None,
                    exit_tick: None,
                }]),
                // 5
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 6
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 7
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 8
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 9
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 10
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 11
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 12
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 13
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 14
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 15
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 16
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 17
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 18
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 19
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 20
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: Some(21.0),
                        exit_tick: Some(20),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(21.0),
                        entry_tick: Some(20),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 21
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: Some(21.0),
                        exit_tick: Some(20),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(21.0),
                        entry_tick: Some(20),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 22
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: Some(21.0),
                        exit_tick: Some(20),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(21.0),
                        entry_tick: Some(20),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 23
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: Some(21.0),
                        exit_tick: Some(20),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(21.0),
                        entry_tick: Some(20),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 24
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: Some(21.0),
                        exit_tick: Some(20),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: false,
                        entry_price: Some(21.0),
                        entry_tick: Some(20),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 25
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: Some(21.0),
                        exit_tick: Some(20),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(21.0),
                        entry_tick: Some(20),
                        exit_price: Some(26.0),
                        exit_tick: Some(25),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(26.0),
                        entry_tick: Some(25),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 26
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: Some(21.0),
                        exit_tick: Some(20),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(21.0),
                        entry_tick: Some(20),
                        exit_price: Some(26.0),
                        exit_tick: Some(25),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(26.0),
                        entry_tick: Some(25),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 27
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: Some(21.0),
                        exit_tick: Some(20),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(21.0),
                        entry_tick: Some(20),
                        exit_price: Some(26.0),
                        exit_tick: Some(25),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(26.0),
                        entry_tick: Some(25),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
                // 28
                Some(vec![
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(4.0),
                        entry_tick: Some(3),
                        exit_price: Some(6.0),
                        exit_tick: Some(5),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(6.0),
                        entry_tick: Some(5),
                        exit_price: Some(9.0),
                        exit_tick: Some(8),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(9.0),
                        entry_tick: Some(8),
                        exit_price: Some(10.0),
                        exit_tick: Some(9),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(10.0),
                        entry_tick: Some(9),
                        exit_price: Some(11.0),
                        exit_tick: Some(10),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(11.0),
                        entry_tick: Some(10),
                        exit_price: Some(16.0),
                        exit_tick: Some(15),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: true,
                        entry_price: Some(16.0),
                        entry_tick: Some(15),
                        exit_price: Some(21.0),
                        exit_tick: Some(20),
                    },
                    Trade {
                        direction: TradeDirection::Short,
                        is_closed: true,
                        entry_price: Some(21.0),
                        entry_tick: Some(20),
                        exit_price: Some(26.0),
                        exit_tick: Some(25),
                    },
                    Trade {
                        direction: TradeDirection::Long,
                        is_closed: false,
                        entry_price: Some(26.0),
                        entry_tick: Some(25),
                        exit_price: None,
                        exit_tick: None,
                    },
                ]),
            ],
        );
    }
}
